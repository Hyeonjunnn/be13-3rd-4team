<template>
  <div class="flex items-center justify-center h-screen px-6 bg-gray-200">
    <div class="w-full max-w-sm p-6 bg-white rounded-md shadow-md">
      <div class="flex items-center justify-center">
        <svg
          version="1.0"
          xmlns="http://www.w3.org/2000/svg"
          width="34.000000pt"
          height="26.000000pt"
          viewBox="0 0 348.000000 263.000000"
          preserveAspectRatio="xMidYMid meet"
        >
          <g
            transform="translate(0.000000,263.000000) scale(0.100000,-0.100000)"
            fill="#3b82f5"
            stroke="none"
          >
            <path
              d="M1567 2473 c-4 -3 -7 -21 -7 -39 0 -26 -7 -39 -33 -58 -18 -14 -44
        -29 -57 -34 -24 -9 -23 -10 21 -29 34 -15 51 -30 66 -62 l20 -41 26 39 c15 22
        40 47 57 57 31 19 39 34 17 34 -21 0 -87 71 -87 94 0 26 -14 49 -23 39z"
            />
            <path
              d="M1473 2085 c-32 -51 -43 -129 -43 -305 0 -232 -31 -309 -196 -490
        -46 -50 -56 -71 -44 -90 13 -21 76 8 186 87 114 82 138 93 198 93 81 0 214
        -112 356 -298 63 -83 92 -108 110 -97 23 14 14 40 -116 300 -41 82 -45 96 -44
        163 0 92 22 138 86 181 52 34 106 40 176 19 27 -8 42 -8 49 -1 16 16 -62 88
        -117 107 -45 15 -51 15 -140 -9 -63 -17 -120 -25 -174 -25 -79 0 -80 0 -132
        43 -29 24 -65 65 -80 92 -25 46 -28 59 -28 158 0 118 -9 132 -47 72z"
            />
            <path
              d="M2246 2013 c-24 -26 -52 -47 -69 -50 -28 -6 -29 -7 -12 -20 11 -7 27
        -13 37 -13 21 0 78 -74 78 -102 0 -11 5 -16 10 -13 6 3 10 16 10 29 0 26 43
        70 83 85 31 12 36 31 8 31 -23 0 -68 41 -81 75 -5 14 -13 25 -17 24 -5 0 -26
        -21 -47 -46z"
            />
            <path
              d="M1705 2030 c-11 -4 -33 -22 -50 -40 -60 -63 -27 -181 60 -210 61 -20
        130 12 160 76 19 41 19 67 -2 111 -28 60 -105 89 -168 63z"
            />
            <path
              d="M987 1929 c-13 -27 -32 -46 -60 -61 l-42 -21 35 -12 c31 -10 67 -49
        84 -88 3 -8 9 -5 17 8 18 28 71 75 86 75 24 0 13 18 -22 39 -22 13 -41 35 -51
        61 -9 22 -19 40 -23 40 -3 0 -14 -19 -24 -41z"
            />
            <path
              d="M2806 1734 c-3 -9 -6 -28 -6 -43 0 -63 -29 -125 -82 -178 -107 -105
        -188 -104 -387 7 -79 44 -167 36 -223 -21 -36 -36 -29 -49 25 -49 49 -1 131
        -42 158 -80 10 -14 24 -46 31 -73 23 -89 -5 -144 -161 -317 -42 -47 -85 -98
        -95 -113 -20 -33 -15 -57 12 -57 21 0 194 110 267 170 58 47 158 100 190 100
        55 0 114 -41 211 -146 96 -104 137 -136 162 -127 21 8 13 42 -23 99 -48 74
        -87 193 -93 282 -5 76 2 112 56 272 40 121 29 290 -18 290 -10 0 -21 -7 -24
        -16z"
            />
            <path
              d="M2501 1723 c-82 -41 -95 -143 -26 -215 22 -24 34 -28 78 -28 32 0 62
        6 75 16 29 20 62 85 62 121 0 41 -35 92 -75 109 -44 18 -72 17 -114 -3z"
            />
            <path
              d="M684 1566 c-30 -30 -34 -40 -34 -88 0 -48 4 -58 33 -85 53 -52 127
        -53 177 -3 15 15 20 33 20 78 0 51 -4 62 -27 84 -65 60 -118 65 -169 14z"
            />
            <path
              d="M456 1524 c-21 -55 6 -141 82 -263 19 -30 51 -89 71 -130 l36 -76 -2
        -140 c-2 -77 -8 -171 -14 -208 -6 -38 -8 -71 -4 -75 14 -14 78 75 124 174 35
        72 59 109 87 132 36 30 44 32 114 32 52 0 92 -6 130 -21 30 -11 64 -23 75 -26
        11 -3 43 -15 70 -27 87 -39 182 -69 199 -63 28 11 6 35 -102 108 -168 114
        -213 154 -249 221 -42 76 -42 110 0 176 38 61 93 102 137 102 37 0 50 25 24
        46 -25 20 -155 10 -193 -14 -14 -9 -55 -46 -91 -81 -105 -103 -192 -126 -290
        -76 -53 27 -144 128 -155 174 -12 47 -37 65 -49 35z"
            />
            <path
              d="M1455 759 c-253 -9 -383 -27 -570 -76 -121 -32 -305 -104 -360 -141
        -46 -31 -106 -52 -150 -52 -41 0 -158 -34 -162 -47 -5 -13 30 -23 79 -23 27 0
        47 -8 70 -29 18 -15 43 -34 56 -40 124 -66 474 -92 952 -72 146 6 405 15 575
        21 757 24 1033 41 1072 66 12 8 43 14 69 14 48 0 179 34 188 49 13 20 -44 41
        -129 47 -81 6 -147 31 -244 90 -50 31 -119 66 -153 78 -35 12 -72 27 -83 33
        -54 29 -286 57 -600 72 -330 17 -407 18 -610 10z"
            />
          </g>
        </svg>
        <span class="text-2xl font-semibold text-gray-700">모여봄</span>
      </div>

      <form class="mt-4" @submit.prevent="login">
        <label class="block">
          <span class="text-sm text-gray-700">사용자 이름</span>
          <input
            type="text"
            class="block w-full mt-1 border-gray-200 rounded-md focus:border-indigo-600 focus:ring focus:ring-opacity-40 focus:ring-indigo-500"
            v-model="userName"
          />
        </label>

        <label class="block mt-3">
          <span class="text-sm text-gray-700">비밀번호</span>
          <input
            type="password"
            class="block w-full mt-1 border-gray-200 rounded-md focus:border-indigo-600 focus:ring focus:ring-opacity-40 focus:ring-indigo-500"
            v-model="password"
          />
        </label>

        <div class="flex items-center justify-between mt-4">
          <div>
            <label class="inline-flex items-center">
              <input
                type="checkbox"
                class="text-indigo-600 border-gray-200 rounded-md focus:border-indigo-600 focus:ring focus:ring-opacity-40 focus:ring-indigo-500"
                v-model="rememberMe"
              />
              <span class="mx-2 text-sm text-gray-600">내 정보 기억</span>
            </label>
          </div>

          <div>
            <a
              class="block text-sm text-indigo-700 fontme hover:underline"
              href="#"
              >비밀번호를 잊으셨나요?</a
            >
          </div>
        </div>

        <div class="mt-6">
          <button
            type="submit"
            class="w-full px-4 py-2 text-sm text-center text-white bg-indigo-600 rounded-md focus:outline-none hover:bg-indigo-500"
          >
            로그인
          </button>
        </div>
      </form>
      <div class="flex space-x-4 mt-3">
        <button
          class="w-full px-4 py-2 text-sm text-center text-white bg-white border-gray-200 text-indigo-700 border border-gray-400 rounded-md focus:outline-none hover:bg-indigo-500 hover:text-white"
          @click="goToGuestLogin"
        >
          비회원 로그인
        </button>
        <button
          class="w-full px-4 py-2 text-sm text-center text-white bg-white border-gray-200 text-indigo-700 border border-gray-400 rounded-md focus:outline-none hover:bg-indigo-500 hover:text-white"
          @click="goToSignUp"
        >
          회원가입
        </button>
      </div>
    </div>
  </div>
</template>

<script>
import axios from "axios";
import { ref } from "vue";
import { useRouter } from "vue-router";

export default {
  setup() {
    const router = useRouter();
    const userName = ref("example");
    const password = ref("@#!@#asdf1231!_!@#");
    const rememberMe = ref(false); // 체크박스 여부

    async function login() {
      try {
        const response = await axios.post("/auth/login", {
          username: userName.value,
          password: password.value,
        });
        console.log(response);
        const token = response.data.accessToken;
        console.log(response.data.message);
        localStorage.setItem("token", token);
        // 내 정보 기억하기
        if (rememberMe.value) {
          console.log(response.data.refreshToken);
          console.log("내 정보 기억 체크됨 (임시)");
        }
        router.push("/dashboard");
      } catch (err) {
        // error.value = "잘못된 사용자 이름 또는 비밀번호입니다.";
        console.log("로그인 실패");
      }
    }

    return {
      userName,
      password,
      rememberMe,
      login,
    };
  },
  methods: {
    goToGuestLogin() {
      this.$router.push("/dashboard");
    },
    goToSignUp() {
      this.$router.push("/sign-up");
    },
  },
};
</script>
